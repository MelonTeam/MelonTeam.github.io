<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>[译]Android TensorFlow机器学习示例</title>
    <meta name="keywords" content="Android, iOS, 深度学习, 人工智能">
    <meta name="description" content="原文地址：&lt;https://blog.mindorks.com/android-tensorflow-machine-learning-example-ff0e9b2654cc&gt;">

    <link rel="shortcut icon" href="/favicon.ico?" type="image/x-icon">
    <link rel="icon" href="/favicon.ico?" type="image/x-icon">
    <link rel="stylesheet" href="https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://at.alicdn.com/t/font_8v3czwksspqlg14i.css">
    <link rel="stylesheet" href="/css/main.css ">
    <link rel="canonical" href="http://MelonTeam.com/posts/yi_android_tensorflow_ji_qi_xue_xi_shi_li/">
    <link rel="alternate" type="application/rss+xml" title="MelonTeam" href="http://MelonTeam.com/feed.xml ">

    <!-- some other meta -->
    
    <!-- some other stuff like link or script -->
    
<!-- UY BEGIN -->
<script type="text/javascript">
var uyan_config = {
     'url':'http://MelonTeam.com/posts/yi_android_tensorflow_ji_qi_xue_xi_shi_li/',
     'du':'http://MelonTeam.com', 
     'su':'http://MelonTeam.com/posts/yi_android_tensorflow_ji_qi_xue_xi_shi_li/' 
};
</script>
<script type="text/javascript" src="http://v2.uyan.cc/code/uyan.js?uid=2136610"></script>
<!-- UY END -->



</head>


  <body>

    <header id="top">
    <div class="wrapper">
        <a href="/" class="brand">MelonTeam</a>
        <small>移动终端前沿技术的探索者</small>
        <button id="headerMenu" class="menu"><i class="fa fa-bars"></i></button>
        <nav id="headerNav">
            <ul>
                <li>
                    
                    <a href="/">
                    
                        <i class="fa fa-home"></i>首页
                    </a>
                </li>

                
                    
                    <li>
                        
                        <a href="/project/">
                        
                            <i class="fa fa-folder-open"></i>开源项目
                        </a>
                    </li>
                    
                
                    
                    <li>
                        
                        <a href="/class/">
                        
                            <i class="fa fa-book"></i>公开课
                        </a>
                    </li>
                    
                
                    
                    <li>
                        
                        <a href="/category/">
                        
                            <i class="fa fa-th-list"></i>分类
                        </a>
                    </li>
                    
                
                    
                    <li>
                        
                        <a href="/board/">
                        
                            <i class="fa fa-pencil"></i>留言板
                        </a>
                    </li>
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </ul>
        </nav>
    </div>
</header>


        <div class="page clearfix" post>
    <div class="left">
        <h1>[译]Android TensorFlow机器学习示例</h1>
        <div class="label">

            <div class="label-card">
                <i class="fa fa-calendar"></i>2017-08-31
            </div>
            
            <div class="label-card">
                <i class="fa fa-user"></i>jennyxia
            </div>
            
            
            
            <div class="label-card">
            




<!-- <span class="point">•</span> -->
<span class="categories">
  <i class="fa fa-th-list"></i>
  
    
        <a href="/category/#未分类" title="Category: 未分类" rel="category">未分类</a>
    
  

  <!-- <span class="point">•</span> -->
</span>



            </div>
            
            
            <div class="label-card">
            


<!-- <span class="point">•</span> -->
<span class="pageTag">
  <i class="fa fa-tags"></i>
  
    
        <!--a href="/tag/#tensorflow" title="Tag: tensorflow" rel="tag">tensorflow</a-->
        <a href="/tag/#tensorflow" title="Tag: tensorflow" rel="tag">tensorflow</a>&nbsp;
    
        <!--a href="/tag/#%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0" title="Tag: 机器学习" rel="tag">机器学习</a-->
        <a href="/tag/#机器学习" title="Tag: 机器学习" rel="tag">机器学习</a>&nbsp;
    
        <!--a href="/tag/#Android" title="Tag: Android" rel="tag">Android</a-->
        <a href="/tag/#Android" title="Tag: Android" rel="tag">Android</a>
    
  

</span>



            </div>
            

        </div>
        <hr>
        <article itemscope itemtype="http://schema.org/BlogPosting">
        <ul id="markdown-toc">
  <li><a href="#" id="markdown-toc-">#</a>    <ul>
      <li><a href="#机器学习将tensorflow集成到android中" id="markdown-toc-机器学习将tensorflow集成到android中">机器学习：将Tensorflow集成到Android中</a></li>
      <li><a href="#1android的构建过程" id="markdown-toc-1android的构建过程">1.Android的构建过程</a>        <ul>
          <li><a href="#2构建jar和so文件" id="markdown-toc-2构建jar和so文件">2.构建jar和.so文件</a></li>
          <li><a href="#3训练模型" id="markdown-toc-3训练模型">3.训练模型</a></li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<p>原文地址：&lt;https://blog.mindorks.com/android-tensorflow-machine-learning-example-
ff0e9b2654cc&gt;</p>

<!--more-->
<h2>#</h2>
<p><img src="/image/yi_android_tensorflow_ji_qi_xue_xi_shi_li/ddbbcacf495f4b2dee33840141469dfec7af4a3ef5eff22f4ff505a9d35d41a0" alt="" /></p>

<h3 id="机器学习将tensorflow集成到android中">机器学习：将Tensorflow集成到Android中</h3>

<p>众所周知，Google已经开放了一个名为<a href="https://www.tensorflow.org/">TensorFlow</a>的开源软件库，可以在Android中应用于机器学习。</p>

<p>我在网上搜索了很多，但没有找到一个简单的方法或一个简单的例子来构建TensorFlow for
Android。自己尝试了很久才构建好。于是我决定写下来，以节省他人时间。</p>

<p>分类器示例来自于Google TensorFlow示例。</p>

<p>本文适用于那些已经熟悉机器学习的人，并且了解如何使用机器学习的构建模型（本例中我将使用 pre-trained
的模型）。很快，我会写一系列关于机器学习的文章，以便每个人都可以学习如何建立机器学习模型。</p>

<h3 id="1android的构建过程">1.Android的构建过程</h3>

<p>几个重要的点，我们应该知道：</p>

<ul>
  <li>TensorFlow的核是用c ++编写的。</li>
  <li>为了构建android，我们必须使用JNI（Java Native Interface）来调用像LoadModel，getPredictions等c ++函数。</li>
  <li>我们将有一个.so（共享对象）文件，它是一个c ++编译的文件和一个jar文件，由一些调用native c ++的JAVA API组成。然后，我们将调用JAVA API来轻松完成任务。</li>
  <li>所以，我们需要jar（Java API）和.so（c ++编译）文件。</li>
  <li>我们必须具有pre-trained 的模型文件和分类的标签文件。</li>
</ul>

<p>下图就是我们将要构建的一个物体识别程序。</p>

<p><img src="/image/yi_android_tensorflow_ji_qi_xue_xi_shi_li/f0da7558ee38c63d52c3eff73623b3a1698459677ebc78726987153962a25a42" alt="" /></p>

<h4 id="2构建jar和so文件">2.构建jar和.so文件</h4>

<div class="highlighter-rouge"><pre class="highlight"><code>git clone --recurse-submodules   &lt;https://github.com/tensorflow/tensorflow.git&gt;
</code></pre>
</div>

<p>注意：<code class="highlighter-rouge">--recurse-submodules</code>拉取submodules</p>

<p>从<a href="downloads">这里</a>下载NDK。<a href="#ndk-12b-downloads"></a></p>

<p>下载Android SDK，或者我们可以提供Android Studio SDK的路径。</p>

<p>从<a href="https://bazel.build/versions/master/docs/install.html">这里</a>安装Bazel。Bazel是TensorFlow的主要构建系统。<a href="https://bazel.build/versions/master/docs/install.html"></a></p>

<p>现在，编辑WORKSPACE文件，我们可以在之前克隆的TensorFlow的根目录中找到WORKSPACE文件。</p>

<div class="highlighter-rouge"><pre class="highlight"><code># Uncomment and update the paths in these entries to build the Android demo.  
#android_sdk_repository(  
#    name = "androidsdk",  
#    api_level = 23,  
#    build_tools_version = "25.0.1",  
#    # Replace with path to Android SDK on your system  
#    path = "",  
#)  
#  
#android_ndk_repository(  
#    name="androidndk",  
#    path="",  
#    api_level=14)
</code></pre>
</div>

<p>这样设置sdk和ndk路径：</p>

<div class="highlighter-rouge"><pre class="highlight"><code>android_sdk_repository(  
    name = "androidsdk",  
    api_level = 23,  
    build_tools_version = "25.0.1",  
    # Replace with path to Android SDK on your system  
    path = "/Users/amitshekhar/Library/Android/sdk/",  
)


android_ndk_repository(  
    name="androidndk",  
    path="/Users/amitshekhar/Downloads/android-ndk-r13/",  
    api_level=14)
</code></pre>
</div>

<p>然后构建.so文件。</p>

<div class="highlighter-rouge"><pre class="highlight"><code>bazel build -c opt //tensorflow/contrib/android:libtensorflow_inference.so \   
   --crosstool_top = // external：android / crosstool \   
   --host_crosstool_top = [@bazel_tools](http://twitter.com/bazel_tools "@bazel_tools的Twitter个人资料" ) // tools / cpp：toolchain \   
   --cpu = armeabi-v7a
</code></pre>
</div>

<p>替换我们所需的armeabi-v7a。</p>

<p>构建玩之后Tensorflow的库将位于：</p>

<div class="highlighter-rouge"><pre class="highlight"><code>bazel-bin/tensorflow/contrib/android/libtensorflow_inference.so
</code></pre>
</div>

<p>构建Jar文件：</p>

<div class="highlighter-rouge"><pre class="highlight"><code>bazel build // tensorflow / contrib / android：android_tensorflow_inference_java
</code></pre>
</div>

<p>我们可以在以下位置找到JAR文件：</p>

<div class="highlighter-rouge"><pre class="highlight"><code>bazel-bin/tensorflow/contrib/android/libandroid_tensorflow_inference_java.jar
</code></pre>
</div>

<p>现在我们有jar和.so文件。我已经构建了.so文件和jar，可以直接从下面的项目中使用。</p>

<p>我创建了一个完整的运行示例应用程序<a href="https://github.com/MindorksOpenSource/AndroidTensorFlowMachineLearningExample">在这里</a>。</p>

<h4 id="3训练模型">3.训练模型</h4>

<p>我们需要预训练的模型和标签文件。</p>

<p>在这个例子中，我们将使用Google预训练的模型，该模型在给定图像上进行对象检测。</p>

<p>我们可以从[这里](</p>

<p>解压缩这个zip文件，我们将获得imagenet_comp_graph_label_strings.txt（对象的标签）和tensorflow_inception_graph.pb（预训练的模型）。</p>

<p>现在，在Android Studio中创建一个Android示例项目。</p>

<p>将imagenet_comp_graph_label_strings.txt和tensorflow_inception_graph.pb放入Assets文件夹。</p>

<p>将libandroid_tensorflow_inference_java.jar放在libs文件夹中，右键单击并添加为库。</p>

<div class="highlighter-rouge"><pre class="highlight"><code>compile files('libs/libandroid_tensorflow_inference_java.jar')
</code></pre>
</div>

<p>在主目录中创建jniLibs文件夹，并将libtensorflow_inference.so放在jniLibs / armeabi-v7a /文件夹中。</p>

<p>现在，我们可以通过一个类<code class="highlighter-rouge">TensorFlowInferenceInterface，</code>调用TensorFlow Java API。</p>

<p>然后，我们可以输入图像来获得检测的结果。</p>

<p>感兴趣的可以直接克隆<a href="https://github.com/MindorksOpenSource/AndroidTensorFlowMachineLearningExample">项目</a>，构建和运行，试试吧。</p>


        </article>
        <hr>

        
        
            
            
                
                    
                
                    
                
                    
                
            
        
            
            
                
                    
                
                    
                
                    
                
            
                
                    
                
                    
                
                    
                
            
        
            
            
                
                    
                
                    
                
                    
                
            
                
                    
                
                    
                
                    
                
            
                
                    
                
                    
                
                    
                        
                        <h2 id="similar_posts">相关文章</h2>
                        <ul>
                        
                        <li class="relatedPost">
                            <a href="/posts/intellij_idea_kai_fa_she_zhi/">IntelliJ IDEA开发设置
                            
                            </a>
                        </li>
                        
                        
                    
                
            
                
                    
                
                    
                
                    
                
            
        
            
            
                
                    
                
                    
                
                    
                        
                        <li class="relatedPost">
                            <a href="/posts/android_pang_men_zuo_dao_zhi_dong_tai_ti_huan_ying_yong_cheng_xu_lei/">Android旁门左道之动态替换应用程序类
                            
                            </a>
                        </li>
                        
                        
                    
                
            
                
                    
                
                    
                
                    
                
            
        
            
            
                
                    
                
                    
                
                    
                        
                        <li class="relatedPost">
                            <a href="/posts/android_dong_tai_quan_xian/">Android动态权限
                            
                            </a>
                        </li>
                        
                        
                    
                
            
                
                    
                
                    
                
                    
                
            
        
            
            
                
                    
                
                    
                
                    
                        
                        <li class="relatedPost">
                            <a href="/posts/opengl_tou_ying_he_she_xiang_ji/">OpenGL-投影和摄像机
                            
                            </a>
                        </li>
                        
                        
                    
                
            
                
                    
                
                    
                
                    
                
            
        
            
            
                
                    
                
                    
                
                    
                
            
                
                    
                
                    
                
                    
                
            
                
                    
                
                    
                
                    
                
            
        
            
            
                
                    
                
                    
                
                    
                        
                        <li class="relatedPost">
                            <a href="/posts/yi_android_interpolator_xiang_jie/">[译]Android Interpolator详解
                            
                            </a>
                        </li>
                        
                        
                    
                
            
                
                    
                
                    
                
                    
                
            
                
                    
                
                    
                
                    
                
            
                
                    
                
                    
                
                    
                
            
        
            
            
                
                    
                
                    
                
                    
                
            
                
                    
                
                    
                
                    
                
            
                
                    
                
                    
                
                    
                
            
        
            
            
                
                    
                
                    
                
                    
                
            
        
        
            </ul>
        

        <div class="post-recent">
    <div class="pre">
        
        <p><strong>上一篇</strong> <a href="/posts/viewpager_xun_huan_hua_dong_de_shi_xian/">Viewpager循环滑动的实现</a></p>
        
    </div>
    <div class="nex">

        
        <p><strong>下一篇</strong> <a href="/posts/yi_android_interpolator_xiang_jie/">[译]Android Interpolator详解</a></p>
        
    </div>
</div>


        <h2 id="comments">说一说</h2>
        

<div id="uyan_frame"></div>





    </div>
    <button class="anchor"><i class="fa fa-anchor"></i></button>
    <div class="right">
        <div class="wrap">

            <!-- Content -->
            <div class="side content">
                <div>
                    目录
                </div>
                <ul id="content-side" class="content-ul">
                    
                    <li><a href="#similar_posts">相关文章</a></li>
                    
                    <li><a href="#comments">说一说</a></li>
                </ul>
            </div>
            <!-- 其他div框放到这里 -->
            <!-- <div class="side">bbbb</div> -->
        </div>
    </div>
</div>
<script>
/**
 * target _blank
 */
(function() {
    var aTags = document.querySelectorAll('article a:not([id])')
    for (var i = 0; i < aTags.length; i++) {
        aTags[i].setAttribute('target', '_blank')
    }
}());
</script>
<script src="/js/pageContent.js " charset="utf-8"></script>


    <footer class="site-footer">


    <div class="wrapper">

        <p class="description">
            
        </p>
        <p class="power">
            <span>
                Copyright © 2017 <a href="https://github.com/MelonTeam" title="GitHub">MelonTeam <i class="fa fa-github" aria-hidden="true"></i></a>. All Rights Reserved.
            </span>
        </p>
    </div>
</footer>


<script type="text/javascript" src="http://tajs.qq.com/stats?sId=62569168" charset="UTF-8"></script>



    <div class="back-to-top">
    <a href="#top" data-scroll>
        <i class="fa fa-arrow-up" aria-hidden="true"></i>
    </a>
</div>

    <script src=" /js/main.js " charset="utf-8"></script>
    <script src=" /js/smooth-scroll.min.js " charset="utf-8"></script>
    <script type="text/javascript">
      smoothScroll.init({
        speed: 500, // Integer. How fast to complete the scroll in milliseconds
        easing: 'easeInOutCubic', // Easing pattern to use
        offset: 20, // Integer. How far to offset the scrolling anchor location in pixels
      });
    </script>
  </body>

</html>
