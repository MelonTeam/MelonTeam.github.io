<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>深度学习入门实战（一）</title>
    <meta name="description" content="  导语：现在人工智能是个大热点，而人工智能离不开机器学习，机器学习中深度学习又是比较热门的方向，本系列文章就从实战出发，介绍下如何使用MXnet进行深度学习~既然是实战而且本文是入门级别的我们就不讲那么多大家都听不懂的数学公式啦～">

    <link rel="shortcut icon" href="/favicon.ico?" type="image/x-icon">
    <link rel="icon" href="/favicon.ico?" type="image/x-icon">
    <link rel="stylesheet" href="https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://at.alicdn.com/t/font_8v3czwksspqlg14i.css">
    <link rel="stylesheet" href="/css/main.css ">
    <link rel="canonical" href="http://MelonTeam.com/posts/Deep_learning_entry_1/">
    <link rel="alternate" type="application/rss+xml" title="MelonTeam" href="http://MelonTeam.com/feed.xml ">



</head>


  <body>

    <header id="top">
    <div class="wrapper">
        <a href="/" class="brand">MelonTeam</a>
        <small>移动终端前沿技术的探索者</small>
        <button id="headerMenu" class="menu"><i class="fa fa-bars"></i></button>
        <nav id="headerNav">
            <ul>
                <li>
                    
                    <a href="/">
                    
                        <i class="fa fa-home"></i>首页
                    </a>
                </li>

                
                    
                    <li>
                        
                        <a href="/project/">
                        
                            <i class="fa fa-folder-open"></i>开源项目
                        </a>
                    </li>
                    
                
                    
                    <li>
                        
                        <a href="/class/">
                        
                            <i class="fa fa-book"></i>公开课
                        </a>
                    </li>
                    
                
                    
                    <li>
                        
                        <a href="/category/">
                        
                            <i class="fa fa-th-list"></i>分类
                        </a>
                    </li>
                    
                
                    
                    <li>
                        
                        <a href="/board/">
                        
                            <i class="fa fa-pencil"></i>留言板
                        </a>
                    </li>
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </ul>
        </nav>
    </div>
</header>


        <div class="page clearfix" post>
    <div class="left">
        <h1>深度学习入门实战（一）</h1>
        <div class="label">

            <div class="label-card">
                <i class="fa fa-calendar"></i>2017-03-28
            </div>
            
            <div class="label-card">
                <i class="fa fa-user"></i>chaodong
            </div>
            
            
            
            <div class="label-card">
            




<!-- <span class="point">•</span> -->
<span class="categories">
  <i class="fa fa-th-list"></i>
  
    
        <a href="/category/#机器学习" title="Category: 机器学习" rel="category">机器学习</a>
    
  

  <!-- <span class="point">•</span> -->
</span>



            </div>
            
            
            <div class="label-card">
            


<!-- <span class="point">•</span> -->
<span class="pageTag">
  <i class="fa fa-tags"></i>
  
    
        <!--a href="/tag/#mxnet" title="Tag: mxnet" rel="tag">mxnet</a-->
        <a href="/tag/#mxnet" title="Tag: mxnet" rel="tag">mxnet</a>&nbsp;
    
        <!--a href="/tag/#%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0" title="Tag: 机器学习" rel="tag">机器学习</a-->
        <a href="/tag/#机器学习" title="Tag: 机器学习" rel="tag">机器学习</a>
    
  

</span>



            </div>
            

        </div>
        <hr>
        <article itemscope itemtype="http://schema.org/BlogPosting">
        <ul id="markdown-toc">
  <li><a href="#0x00-深度学习简介" id="markdown-toc-0x00-深度学习简介">0x00 深度学习简介</a>    <ul>
      <li><a href="#机器学习" id="markdown-toc-机器学习">机器学习：</a></li>
      <li><a href="#神经网络" id="markdown-toc-神经网络">神经网络：</a>        <ul>
          <li><a href="#神经元" id="markdown-toc-神经元">神经元：</a></li>
          <li><a href="#神经网络-1" id="markdown-toc-神经网络-1">神经网络：</a></li>
        </ul>
      </li>
      <li><a href="#深度学习" id="markdown-toc-深度学习">深度学习：</a></li>
    </ul>
  </li>
  <li><a href="#0x01-安装mxnet" id="markdown-toc-0x01-安装mxnet">0x01 安装MXnet</a>    <ul>
      <li><a href="#1-下载源码" id="markdown-toc-1-下载源码">1. 下载源码</a></li>
      <li><a href="#2-编译安装" id="markdown-toc-2-编译安装">2. 编译安装</a></li>
    </ul>
  </li>
  <li><a href="#0x02-样例运行" id="markdown-toc-0x02-样例运行">0x02 样例运行</a></li>
</ul>
<blockquote>
  <p>导语：现在人工智能是个大热点，而人工智能离不开机器学习，机器学习中深度学习又是比较热门的方向，本系列文章就从实战出发，介绍下如何使用MXnet进行深度学习~</p>
</blockquote>

<p>既然是实战而且本文是入门级别的我们就不讲那么多大家都听不懂的数学公式啦～</p>

<!--more-->

<h2 id="0x00-深度学习简介">0x00 深度学习简介</h2>

<p>虽然吧，我们不讲哪些深奥的数学原理，但是基本的原理还是要掌握下的～</p>

<p>在介绍深度学习之前我们要先了解两个概念，机器学习和神经网络</p>

<h3 id="机器学习">机器学习：</h3>

<p>在介绍深度学习之前，我们先简单介绍下机器学习，我们引用下维基百科上机器学习的定义：</p>

<p>机器学习是人工智能的一个分支。人工智能的研究是从以“推理”为重点到以“知识”为重点，再到以“学习”为重点，一条自然、清晰的脉络。显然，机器学习是实现人工智能的一个途径，即以机器学习为手段解决人工智能中的问题。机器学习在近30多年已发展为一门多领域交叉学科，涉及概率论、统计学、逼近论、凸分析、计算复杂性理论等多门学科。机器学习理论主要是设计和分析一些让计算机可以自动“学习”的算法。机器学习算法是一类从数据中自动分析获得规律，并利用规律对未知数据进行预测的算法。因为学习算法中涉及了大量的统计学理论，机器学习与推断统计学联系尤为密切，也被称为统计学习理论。算法设计方面，机器学习理论关注可以实现的，行之有效的学习算法。很多推论问题属于无程序可循难度，所以部分的机器学习研究是开发容易处理的近似算法。</p>

<p>简单的说机器学习就是让机器去分析数据找规律，并通过找到的规律对新的数据进行处理。</p>

<h3 id="神经网络">神经网络：</h3>

<h4 id="神经元">神经元：</h4>

<p><img src="/image/Deep_learning_entry/1.png" alt="Alt text" /></p>

<p>以图像为例子，每个数据或者输入就是一张图片，而里面的每个x可以是图片中的每个像素。对于每个像素我们都赋予一个权重，然后经过转换函数（Transfer Function, 这里是线性叠加）得到一个数值。简单来说，我们对所有像素做个线性加权叠加。得到的数值会经过激活函数得到新的数值。这个激活函数（Activation Function）往往是那几个符合某些特性的非线性函数。为什么需要非线性的转换呢？举个简单的例子，在同一个平面你和你的影子是重叠是分不开的，在立体的空间你们却能分开了。非线性的转换有类似的作用。常用的激活函数有relu, softmax, tanh。</p>

<p>简单的说一个神经元是一个简单的分类器，你输入一个</p>

<p>比如我们有一大堆猫、狗照片，把每一张照片送进一个机器里，机器需要判断这幅照片里的东西是猫还是狗。我们把猫狗图片处理一下，左边是狗的特征向量，右边是猫的</p>

<p><img src="/image/Deep_learning_entry/2.png" alt="Alt text" /></p>

<p>大家想想，最简单地把这两组特征向量分开的方法是啥？当然是在两组数据中间画一条竖直线，直线左边是狗，右边是猫，分类器就完成了。以后来了新的向量，凡是落在直线左边的都是狗，落在右边的都是猫。
一条直线把平面一分为二，一个平面把三维空间一分为二，一个n-1维超平面把n维空间一分为二，两边分属不同的两类，这种分类器就叫做神经元。
当然，上面那幅图我们是开了上帝视角才知道“一条竖直线能分开两类”，在实际训练神经元时，我们并不知道特征是怎么抱团的。神经元模型的一种学习方法称为Hebb算法：
先随机选一条直线/平面/超平面，然后把样本一个个拿过来，如果这条直线分错了，说明这个点分错边了，就稍微把直线移动一点，让它靠近这个样本，争取跨过这个样本，让它跑到直线正确的一侧；如果直线分对了，它就暂时停下不动。因此训练神经元的过程就是这条直线不断在跳舞，最终跳到两个类之间的竖直线位置。</p>

<h4 id="神经网络-1">神经网络：</h4>

<p>神经网络简单点将就是由好多个神经元组成的系统。</p>

<p>神经元一个缺点是：它只能切一刀！你给我说说一刀怎么能把下面这两类分开吧。</p>

<p><img src="/image/Deep_learning_entry/3.png" alt="Alt text" /></p>

<p>解决办法是多层神经网络，底层神经元的输出是高层神经元的输入。我们可以在中间横着砍一刀，竖着砍一刀，然后把左上和右下的部分合在一起，与右上的左下部分分开；也可以围着左上角的边沿砍10刀把这一部分先挖出来，然后和右下角合并。</p>

<p>每砍一刀，其实就是使用了一个神经元，把不同砍下的半平面做交、并等运算，就是把这些神经元的输出当作输入，后面再连接一个神经元。这个例子中特征的形状称为异或，这种情况一个神经元搞不定，但是两层神经元就能正确对其进行分类。</p>

<p>只要你能砍足够多刀，把结果拼在一起，什么奇怪形状的边界神经网络都能够表示，所以说神经网络在理论上可以表示很复杂的函数/空间分布。但是真实的神经网络是否能摆动到正确的位置还要看网络初始值设置、样本容量和分布。</p>

<h3 id="深度学习">深度学习：</h3>

<p>那什么是深度学习呢？深度学习简单点说就是一种为了让层数较多的多层神经网络可以训练，能够运行起来而演化出来的一系列的新的结构和新的方法。</p>

<p>就像下图</p>

<p><img src="/image/Deep_learning_entry/4.png" alt="Alt text" /></p>

<p>普通的神经网络可能只有几层，深度学习可以达到十几层。深度学习中的深度二字也代表了神经网络的层数。现在流行的深度学习网络结构有”CNN(卷积神经网络)、RNN(循环神经网络)、DNN(深度神经网络)的等。</p>

<p>当然我们是以实战为主，可以直接使用现在市面上的一些现有深度学习框架，现在流行的深度学习框架有MXnet,tensorflow,caffe等，本文主要介绍<a href="https://github.com/dmlc/mxnet">MXnet</a>这个开源的优秀深度学习框架。</p>

<h2 id="0x01-安装mxnet">0x01 安装MXnet</h2>

<p>这里我们安装的是CPU版的MXnet，为什么不安装GPU版？因为偶的Macbook是AMD的卡啊，MXnet只支持CUDA</p>

<h4 id="1-下载源码">1. 下载源码</h4>

<p>新建一个目录，到那个目录下执行</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code>git clone --recursive https://github.com/dmlc/mxnet
</code></pre>
</div>

<h4 id="2-编译安装">2. 编译安装</h4>
<p>运行setup-utils目录下的install-mxnet-osx.sh脚本，中间要编译些东西，要多等会，再输入个密码，就自动编译安装完成啦。
注意一下：
1.因为要读取make目录下的文件，所以这里要在MXnet源码的根目录执行安装脚本～
比如在mxnet的源码根目录执行</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code>sh ./setup-utils/install-mxnet-osx.sh
</code></pre>
</div>

<p>2.以后运行脚本可能需要一些python模块，建议安装下pip
mac下安装的方法也很简单：</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code> sudo easy_install pip
</code></pre>
</div>

<h2 id="0x02-样例运行">0x02 样例运行</h2>
<p>我们可以试着运行下MXnet自带的一些样例，这里我们试下Neural art这个样例
Neural art是个让机器模仿已有画作的绘画风格来把一张照片重新绘画的算法。
比如我们输入
<img src="/image/Deep_learning_entry/5.jpg" alt="Alt text" />
和
<img src="/image/Deep_learning_entry/6.jpg" alt="Alt text" /></p>

<p>最终生成
<img src="/image/Deep_learning_entry/7.jpg" alt="Alt text" /></p>

<p>1.首先打开example/neural-style目录，大部分样例都是有README的，大家在运行之前可以先看看
这个样例的README有说
First use <code class="highlighter-rouge">download.sh</code> to download pre-trained model and sample inputs</p>

<p>Then run <code class="highlighter-rouge">python nstyle.py</code>, use -h to see more options</p>

<p>那我们就要运行这个目录下的download.sh</p>

<p>脚本会自动下载训练模型vgg19.params到Model目录，输入的素材到input目录</p>

<p>2.运行Demo
因为我们运行的是CPU版，所以要这么输入</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code>python nstyle.py --gpu -1 --max-num-epochs 150 --output_dir ~/Desktop/
</code></pre>
</div>

<p>–gpu：使用哪个一个GPU,-1代表使用CPU
–max-num-epochs：最大迭代次数，这里我们迭代150次
–output_dir：结果输出路径
可能大家一次运行不起来，会出现No module named for xxx的提示，一般是相应的python模块没有安装，在google搜下No module named for xxx一般都能找到安装方法，大部分都能通过pip安装~</p>

<p>运行结果
我们看下不同迭代次数时的结果是什么样的
10次：</p>

<p><img src="/image/Deep_learning_entry/8.jpg" alt="Alt text" /></p>

<p>50次：</p>

<p><img src="/image/Deep_learning_entry/9.jpg" alt="Alt text" /></p>

<p>100次：</p>

<p><img src="/image/Deep_learning_entry/10.jpg" alt="Alt text" /></p>

<p>150次：</p>

<p><img src="/image/Deep_learning_entry/11.jpg" alt="Alt text" /></p>

<p>可以看出迭代次数越多效果越好~当然由于深度学习是有很多层神经网络组成，需要的运算量巨大，使用CPU即使是i7，150次迭代也需要好几十分钟了，有条件的看官可以尝试使用GPU版，可以将时间缩短到几分钟，甚至在云平台上跑。
样例的具体原理可以参考参考附录的第二个链接。</p>

<p><strong>参考附录：</strong></p>

<p>http://www.leiphone.com/news/201608/wh8osGY4vg28XlvM.html
http://phunter.farbox.com/post/mxnet-tutorial2
https://zhuanlan.zhihu.com/p/20634163
http://www.cnblogs.com/peizhe123/p/4641149.html</p>

        </article>
        <hr>

        
        
            
            
                
                    
                
                    
                
            
                
                    
                
                    
                
            
        
            
            
                
                    
                
                    
                
            
        
            
            
                
                    
                
                    
                
            
                
                    
                
                    
                
            
        
            
            
                
                    
                
                    
                
            
        
            
            
                
                    
                
                    
                
            
        
            
            
                
                    
                
                    
                
            
                
                    
                
                    
                
            
        
            
            
                
                    
                
                    
                
            
                
                    
                
                    
                
            
        
            
            
                
                    
                
                    
                
            
                
                    
                
                    
                
            
        
            
            
                
                    
                
                    
                
            
                
                    
                
                    
                
            
        
            
            
                
                    
                
                    
                
            
                
                    
                
                    
                
            
        
        

        <div class="post-recent">
    <div class="pre">
        
        <p><strong>上一篇</strong> <a href="/posts/Video_codec_learning_sharing/">视频编解码学习分享</a></p>
        
    </div>
    <div class="nex">

        
        <p><strong>下一篇</strong> <a href="/posts/Deep_learning_entry_2/">深度学习入门实战（二）</a></p>
        
    </div>
</div>


        <h2 id="comments">说一说</h2>
        

<!-- UY BEGIN -->
<div id="uyan_frame"></div>
<script type="text/javascript">
var uyan_config = {
     'url':'http://MelonTeam.com/posts/Deep_learning_entry_1/',
     'du':'http://MelonTeam.com', 
     'su':'http://MelonTeam.com/posts/Deep_learning_entry_1/' 
};
</script>
<script type="text/javascript" src="http://v2.uyan.cc/code/uyan.js?uid=2136610"></script>
<!-- UY END -->






    </div>
    <button class="anchor"><i class="fa fa-anchor"></i></button>
    <div class="right">
        <div class="wrap">

            <!-- Content -->
            <div class="side content">
                <div>
                    目录
                </div>
                <ul id="content-side" class="content-ul">
                    
                    <li><a href="#comments">说一说</a></li>
                </ul>
            </div>
            <!-- 其他div框放到这里 -->
            <!-- <div class="side">bbbb</div> -->
        </div>
    </div>
</div>
<script>
/**
 * target _blank
 */
(function() {
    var aTags = document.querySelectorAll('article a:not([id])')
    for (var i = 0; i < aTags.length; i++) {
        aTags[i].setAttribute('target', '_blank')
    }
}());
</script>
<script src="/js/pageContent.js " charset="utf-8"></script>


    <footer class="site-footer">


    <div class="wrapper">

        <p class="description">
            
        </p>
        <p class="power">
            <span>
                Copyright © 2017 <a href="https://github.com/MelonTeam" title="GitHub">MelonTeam <i class="fa fa-github" aria-hidden="true"></i></a>. All Rights Reserved.
            </span>
        </p>
    </div>
</footer>


<script type="text/javascript" src="http://tajs.qq.com/stats?sId=62569168" charset="UTF-8"></script>



    <div class="back-to-top">
    <a href="#top" data-scroll>
        <i class="fa fa-arrow-up" aria-hidden="true"></i>
    </a>
</div>

    <script src=" /js/main.js " charset="utf-8"></script>
    <script src=" /js/smooth-scroll.min.js " charset="utf-8"></script>
    <script type="text/javascript">
      smoothScroll.init({
        speed: 500, // Integer. How fast to complete the scroll in milliseconds
        easing: 'easeInOutCubic', // Easing pattern to use
        offset: 20, // Integer. How far to offset the scrolling anchor location in pixels
      });
    </script>
  </body>

</html>
